{
<<<<<<< HEAD
    "admin": {
        "listen": "167.235.155.72:2019"
    },
    "apps": {
        "http": {
            "servers": {
                "Cloud_Guardian": {
                    "listen": ["0.0.0.0:80"],
                    "timeouts": {
                        "read_header_timeout": "15s",
                        "idle_timeout": "5m",
                        "write_timeout": "15s",
                        "header_timeout": "10s"
                    },
                    "max_connections": 50,  
                    "max_requests_per_connection": 20,  
                    "routes": [
                        {
                            "match": [
                                {
                                    "host": ["juan.localhost"],
                                    "path": ["/login"]  
                                }
                            ],
                            "handle": [
                                {
                                    "handler": "rate_limit",  
                                    "rate_limit": {
                                        "requests": 3,  
                                        "window": "1m"  
                                    }
                                },
                                {
                                    "handler": "authenticate",  
                                    "basic": {
                                        "users": {
                                            "juan": "1234"
                                        }
                                    }
                                },
                                {
                                    "handler": "static_response",
                                    "body": "Acceso concedido a Juan"
                                }
                            ]
                        },
                        {
                            "match": [
                                {
                                    "host": ["juan.localhost"],
                                    "path": ["/"]  
                                }
                            ],
                            "handle": [
                                {
                                    "handler": "rate_limit",  
                                    "rate_limit": {
                                        "requests": 5,  
                                        "window": "1m"  
                                    }
                                },
                                {
                                    "handler": "static_response",
                                    "body": "P치gina principal accesible para Juan"
                                }
                            ]
                        },
                        {
                            "match": [
                                {
                                    "host": ["pepe.localhost"],
                                    "path": ["/login"] 
                                }
                            ],
                            "handle": [
                                {
                                    "handler": "rate_limit",  
                                    "rate_limit": {
                                        "requests": 3,  
                                        "window": "1m"  
                                    }
                                },
                                {
                                    "handler": "authenticate",  
                                    "basic": {
                                        "users": {
                                            "pepe": "5678"
                                        }
                                    }
                                },
                                {
                                    "handler": "static_response",
                                    "body": "Acceso concedido a Pepe"
                                }
                            ]
                        },
                        {
                            "match": [
                                {
                                    "host": ["pepe.localhost"],
                                    "path": ["/"]  
                                }
                            ],
                            "handle": [
                                {
                                    "handler": "rate_limit",  
                                    "rate_limit": {
                                        "requests": 7,  
                                        "window": "1m"  
                                    }
                                },
                                {
                                    "handler": "static_response",
                                    "body": "P치gina principal accesible para Pepe"
                                }
                            ]
                        },
                        {
                            "match": [
                                {
                                    "path": ["/api/*"]
                                }
                            ],
                            "handle": [
                                {
                                    "handler": "reverse_proxy",
                                    "upstreams": [
                                        {
                                            "dial": "localhost:5000"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "match": [
                                {
                                    "path": ["/"]
                                }
                            ],
                            "handle": [
                                {
                                    "handler": "static_response",
                                    "body": "P치gina principal accesible para IPs permitidas"
                                }
                            ]
                        }
                    ]
                }
=======
  "admin": {
    "listen": "167.235.155.72:2019"
  },
  "apps": {
    "http": {
      "servers": {
        "Cloud_Guardian": {
          "listen": [":80"],
          "timeouts": {
            "read_header_timeout": "15s",
            "idle_timeout": "5m",
            "write_timeout": "15s",
            "header_timeout": "10s"
          },
          "max_connections": 50,
          "max_requests_per_connection": 20,
          "routes": [
            {
              "match": [
                {
                  "path": ["/api/*"]
                }
              ],
              "handle": [
                {
                  "handler": "reverse_proxy",
                  "upstreams": [
                    {
                      "dial": "django:8000"
                    }
                  ]
                }
              ]
            },
            {
              "match": [
                {
                  "path": ["/assets/*", "/vite.svg"]
                }
              ],
              "handle": [
                {
                  "handler": "file_server",
                  "root": "/srv"
                }
              ]
            },
            {
              "match": [
                {
                  "not": [
                    {
                      "path": ["/api/*", "/assets/*", "/vite.svg"]
                    }
                  ]
                }
              ],
              "handle": [
                {
                  "handler": "rewrite",
                  "uri": "/index.html"
                }
              ]
            },
            {
              "handle": [
                {
                  "handler": "file_server",
                  "root": "/srv",
                  "index_names": ["index.html"]
                }
              ]
            },
            {
              "match": [
                {
                  "path": ["/login"]
                }
              ],
              "handle": [
                {
                  "handler": "rate_limit",
                  "rate_limit": {
                    "requests": 3,
                    "window": "1m"
                  }
                },
                {
                  "handler": "authenticate",
                  "basic": {
                    "users": {
                      "admin": "1234",
                      "Alberto": "5678",
                      "Ian": "9123",
                      "Jose": "4567",
                      "Jaime": "8901"
                    }
                  }
                },
                {
                  "handler": "static_response",
                  "body": "Acceso a /login concedido"
                }
              ]
            },
            {
              "match": [
                {
                  "path": ["/"]
                }
              ],
              "handle": [
                {
                  "handler": "static_response",
                  "body": "P치gina principal accesible para IPs permitidas"
                }
              ]
>>>>>>> 025d142de880f64ebc1c8421f56a6b9c95364933
            }
          ]
        }
      },
      "security": {
        "remote_ip": {
          "allow": ["100.10.10.1", "192.168.1.100"],
          "deny": ["0.0.0.0/0", "192.168.0.0/24"]
        }
      }
    }
  }
}
